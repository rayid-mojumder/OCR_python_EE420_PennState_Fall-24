The last part of Figure - 1, the final FFT gives flipped result. To avoid that use inverse FFT. 
